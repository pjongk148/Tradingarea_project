View(metan)
gaman <- read.csv("data/지역화폐가맹점현황.csv")
#데이터 전처리: 업종명 변경
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식서양음식"="일반휴게음식-서양음식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 - 서양음식"="일반휴게음식-서양음식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 - 일반한식"="일반휴게음식-일반한식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 / 일반한식"="일반휴게음식-일반한식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식일반한식"="일반휴게음식-일반한식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식한정식"="일반휴게음식-한정식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식-일식?회집"="일반휴게음식-일식회집")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식일식?회집"="일반휴게음식-일식회집")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 - 일식?회집"="일반휴게음식-일식회집")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식중국식"="일반휴게음식-중국식")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식위탁급식업"="일반휴게음식-위탁급식업")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 - 스넥"="일반휴게음식-스넥")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식스넥"="일반휴게음식-스넥")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식주점"="일반휴게음식-주점")
gaman$업종명.종목명. <- recode (gaman$업종명.종목명., "일반휴게음식 - 주점"="일반휴게음식-주점")
gaman1 <- gaman
#이상치 제거
gaman1 <- subset(gaman1, str_extract(gaman1$소재지도로명주소,"수원")=="수원")
gaman_data_food <- gaman1 %>% select(상호명,업종명.종목명.,소재지도로명주소) %>% filter(str_extract(gaman1$업종명.종목명.,"음식")=="음식")
youngtong <- gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"영통동")=="영통동")
View(youngtong)
metan <- gaman_data_food %>% filter(str_extract(gaman_data_food$상호명,"매탄")=="매탄")
View(metan)
metan <- gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"매탄")=="매탄")
View(metan)
View(metan %>% filter(str_extract(metan$상호명,"카페")=="카페"))
#### 연령별 인구현황
gaman <- read.csv("data/202012_연령별인구현황_연간.csv")
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
View(ingoo)
youngtong <- gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"영통")=="영통")
View(youngtong)
View(gaman_dead)
View(ingoo)
ingoo[37]
ingoo[37,]
youngtonggoo <- ingoo[37,]
ingoo_y< -ingoo[c(43:45),]
ingoo_y <-ingoo[c(43:45),]
ingoo_m <-ingoo[c(38:41),]
ingoo_i <-ingoo[35,]
View(ingoo_y)
str(ingoo)
ingoo %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% summarise(전체인구=sum(X2020년_거주자_20.29세,X2020년_거주자_30.39세,X2020년_거주자_40.49세)) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% summarise("전체인구"=sum(X2020년_거주자_20.29세,X2020년_거주자_30.39세,X2020년_거주자_40.49세)) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% summarise(인구=sum(X2020년_거주자_20.29세,X2020년_거주자_30.39세,X2020년_거주자_40.49세)) %>% arrange(X2020년_거주자_20.29세 )
sum(X2020년_거주자_20.29세,X2020년_거주자_30.39세,X2020년_거주자_40.49세)
sum(ingoo$X2020년_거주자_20.29세,ingoo$X2020년_거주자_30.39세,ingoo$X2020년_거주자_40.49세)
ingoo %>% summarise(인구=X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% group_by(행정구역) %>% summarise(인구=X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% group_by(행정구역) %>% summarise(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% group_by(행정구역) %>% arrange(X2020년_거주자_20.29세 )
ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)
)
ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세))
ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
View(ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5))
sort(ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5))
sort(ingoo$X2020년_거주자_20.29세)
str(ingoo)
int(ingoo)
as.numeric(ingoo)
ingoo %>%
mutate_if(is.factor, .funs = "as.character") -> ingoo
sapply(ingoo, "class")
ingoo %>%
mutate_if(is.factor, .funs = "as.numeric") -> ingoo
sapply(ingoo, "numeric")
ingoo %>%
mutate_if(is.factor, .funs = "as.character") -> ingoo
str(ingoo)
ingoo %>%
mutate_if(is.factor, .funs = "as.numeric") -> ingoo
str(ingoo)
ingoo %>%
mutate_if(is.character, .funs = "as.numeric") -> ingoo
str(ingoo)
ingoo[,i] <- imsi;
size_my_data_frame = dim(ingoo);
for(i in 1:size_my_data_frame[2]){
imsi = as.numeric(ingoo[,i]);
imsi[is.na(imsi)] <- 0     #해당 열에서 NA 값이 있을 경우 0으로 변환
ingoo[,i] <- imsi;
}
str(Ingo)
str(ingoo)
int("33")
num("33")
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
View(ingoo)
size_my_data_frame = dim(ingoo);
for(i in 1:size_my_data_frame[2]){
imsi = as.numeric(ingoo[,i]);
imsi[is.na(imsi)] <- 0     #해당 열에서 NA 값이 있을 경우 0으로 변환
ingoo[,i] <- imsi;
}
str(ingoo)
ingoo_y <-ingoo[c(43:45),]
ingoo_m <-ingoo[c(38:41),]
ingoo_i <-ingoo[35,]
View(ingoo_y)
View(ingoo)
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
for(i in 2:size_my_data_frame[2]){
imsi = as.numeric(ingoo[,i]);
imsi[is.na(imsi)] <- 0     #해당 열에서 NA 값이 있을 경우 0으로 변환
ingoo[,i] <- imsi;
}
w(
View(ingoo)
}
View(ingoo)
View(ingoo %>% group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5))
View(ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
(group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
(group_by(행정구역)) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
View(ingoo)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_20
View(ingoo_20)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(비율=X2020년_거주자_20.29세/185979) %>% head(5)
View(ingoo_20)
str(ingoo)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(비율=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)/(185979+177436+200933)) %>% head(5)
View(ingoo_20)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(비율=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% head(5)
View(ingoo_20)
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(비율=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(비율)) %>% head(5)
View(ingoo_total)
ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동")
ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(비율)
ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(전체인구)
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_total
View(ingoo_20)
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
g
str(ingoo)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_여_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_여_거주자_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.9세)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(남전체인구)) %>% head(5)
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(남전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(여전체인구=(X2020년_여_거주자_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(여전체인구)) %>% head(5)
View(ingoo_total)
ggplot(ingoo_total, aes(행정구역, 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수")
ggplot(ingoo_total, aes(행정구역, 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동')
ggplot(ingoo_total, aes(reorder(행정구역,전체인구), 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동')
dimnames(ingoo_total)=list(row=c("율천동","원천동","광교1동","호매실동","권선2동"))
dimnames(ingoo_total)=list(row=c("율천동","원천동","광교1동","호매실동","권선2동"),col="인구수")
dimnames(ingoo_total)=list(row=c("율천동","원천동","광교1동","호매실동","권선2동"),col=names("인구수"))
View(ingoo_20)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세)
View(ingoo_30)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세)
View(ingoo_30)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
View(ingoo_30)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
View(ingoo_20)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(남전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(여전체인구=(X2020년_여_거주자_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(여전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_40.49세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
View(ingoo_20)
View(ingoo_man)
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_여_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동')
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동')
ggplot(ingoo_total, aes(reorder(행정구역,전체인구), 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 총인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 20대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_30, aes(reorder(행정구역,X2020년_거주자_30.39세), X2020년_거주자_30.39세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 30대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_40, aes(reorder(행정구역,X2020년_거주자_40.49세), X2020년_거주자_40.49세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 40대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_man, aes(reorder(행정구역,남전체인구), 남전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 남자 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_woman, aes(reorder(행정구역,여전체인구), 여전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 여자 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ingoo_y
sum(ingoo_y$X2020년_거주자_20.29세)
rbind(c(ingoo_y,ingoo_m,ingoo_i))
View(rbind(c(ingoo_y,ingoo_m,ingoo_i)))
View(cbind(c(ingoo_y,ingoo_m,ingoo_i)))
View(cbind(ingoo_y,ingoo_m,ingoo_i))
View(cbind(ingoo_y,ingoo_m,ingoo_i))
View(rbind(ingoo_y,ingoo_m,ingoo_i))
ingoo_i
ingoo_y <-ingoo[c(43:45),]
ingoo_m <-ingoo[c(38:41),]
ingoo_i <-ingoo[35,]
View(rbind(ingoo_y,ingoo_m,ingoo_i))
sum(ingoo_y$X2020년_거주자_20.29세)
ingoo_y %>%
mutate_all(cumsum)
View(ingoo_y %>%
mutate_all(cumsum))
View(ingoo_y)
View(ingoo_y %>%
mutate_all(cumsum))
ingoo_y <- ingoo_y[3,]
View(ingoo_y)
ingoo_y <-ingoo_y %>%
mutate_all(cumsum)
ingoo_y <- ingoo_y[3,]
View(ingoo_y)
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
ingoo_y <-ingoo[c(43:45),]
ingoo_y <-ingoo_y %>%
mutate_all(cumsum)
View(ingoo_y)
ingoo_y <- ingoo_y[3,]
View(ingoo_y)
rownames(ingoo_y)="영통동"
View(ingoo_y)
ingoo_y <-ingoo[c(43:45),]
ingoo_y <-ingoo_y %>%
mutate_all(cumsum)
ingoo_y <- ingoo_y[3,]
ingoo_y$행정구역="영통동"
View(ingoo_y)
ingoo_m <-ingoo_m %>%
mutate_all(cumsum)
ingoo_m <- ingoo_y[4,]
ingoo_m$행정구역="매탄동"
View(ingoo_m)
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
ingoo_m <-ingoo[c(38:41),]
ingoo_m <-ingoo_m %>%
mutate_all(cumsum)
View(ingoo_m)
ingoo_m <- ingoo_m[4,]
ingoo_m$행정구역="매탄동"
View(ingoo_m)
ingoo_i
ingoo_i$행정구역 = "인계동"
ingoo_i
View(ingoo_i)
View(rbind(ingoo_y,ingoo_m,ingoo_i))
ingoo <- (rbind(ingoo_y,ingoo_m,ingoo_i))
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_40.49세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(남전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(여전체인구=(X2020년_여_거주자_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(여전체인구)) %>% head(5)
View(ingoo_20)
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
View(ingoo)
ggplot(ingoo_total, aes(reorder(행정구역,전체인구), 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 총인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 20대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ingoo <- (rbind(ingoo_y,ingoo_m,ingoo_i))
ingoo_total <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(전체인구=(X2020년_거주자_20.29세+X2020년_거주자_30.39세+X2020년_거주자_40.49세)) %>% arrange(desc(전체인구)) %>% head(5)
ingoo_20 <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_20.29세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_20.29세)) %>% head(5)
ingoo_30 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_30.39세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_30.39세)) %>% head(5)
ingoo_40 <- ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>% select(행정구역,X2020년_거주자_40.49세) %>%
group_by(행정구역) %>% arrange(desc(X2020년_거주자_40.49세)) %>% head(5)
ingoo_man <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(남전체인구=(X2020년_남_거주자_20.29세+X2020년_남_거주자_30.39세+X2020년_남_거주자_40.49세)) %>% arrange(desc(남전체인구)) %>% head(5)
ingoo_woman <-  ingoo %>% filter(str_extract(ingoo$행정구역,"동")=="동") %>%
group_by(행정구역) %>% summarise(여전체인구=(X2020년_여_거주자_20.29세+X2020년_여_거주자_30.39세+X2020년_여_거주자_40.49세)) %>% arrange(desc(여전체인구)) %>% head(5)
ggplot(ingoo_total, aes(reorder(행정구역,전체인구), 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 총인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 20대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_30, aes(reorder(행정구역,X2020년_거주자_30.39세), X2020년_거주자_30.39세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 30대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_40, aes(reorder(행정구역,X2020년_거주자_40.49세), X2020년_거주자_40.49세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 40대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_man, aes(reorder(행정구역,남전체인구), 남전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 남자 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_total, aes(reorder(행정구역,전체인구), 전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 총인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_20, aes(reorder(행정구역,X2020년_거주자_20.29세), X2020년_거주자_20.29세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 20대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_30, aes(reorder(행정구역,X2020년_거주자_30.39세), X2020년_거주자_30.39세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 30대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_40, aes(reorder(행정구역,X2020년_거주자_40.49세), X2020년_거주자_40.49세, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 40대 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_man, aes(reorder(행정구역,남전체인구), 남전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 남자 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(ingoo_woman, aes(reorder(행정구역,여전체인구), 여전체인구, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동별") + ylab("인구수") + scale_fill_discrete(name='동') +ggtitle("동별 여자 인구수")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
#### 연령별 인구현황
ingoo <- read.csv("data/202012_연령별인구현황_연간.csv")
View(ingoo)
gg <- gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"광교")=="광교")
View(gg)
gaman_data_food
View(gaman_data_food)
yoodong <- read_excel(path="data/역별 유동인구 현황 2020년12월말기준.xls")
View(yoodong)
yoodong %>% arrange(desc(여객_승차인원))
yoodong %>% arrange(desc(여객_강차인원))
yoodong %>% arrange(desc(여객_강차인원)) %>% head(5)
yoodong %>% arrange(desc(여객_승차인원)) %>% head(5)
yoodong
yoodong[c(5,6,7,8,9),]
yoodong2 <- yoodong[c(5,6,7,8,9),]
yoodong2 %>% arrange(desc(여객_승차인원)) %>% head(5)
yoodong2 %>% arrange(desc(여객_강차인원)) %>% head(5)
total_s <- yoodong %>% select(구분,여객_승차인원) %>% arrange(desc(여객_승차인원)) %>% head(5)
total_g <-yoodong %>% select(구분,여객_강차인원) %>% arrange(desc(여객_강차인원)) %>% head(5)
big3_s <- yoodong2 %>% select(구분,여객_승차인원) %>% arrange(desc(여객_승차인원)) %>% head(5)
big3_g <- yoodong2 %>% select(구분,여객_승차인원) %>% arrange(desc(여객_강차인원)) %>% head(5)
big3_g <- yoodong2 %>% select(구분,여객_강차인원) %>% arrange(desc(여객_강차인원)) %>% head(5)
ggplot(total_s, aes(reorder(구분),여객_승차인원), 여객_승차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("전체 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(total_s, aes(reorder(구분,여객_승차인원), 여객_승차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("전체 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
###잡다한거
View(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"매산")=="매산"))
View(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"평동")=="평동"))
View(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"서둔")=="서둔"))
str(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"서둔")=="서둔"))
str(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"평동")=="평동"))
###잡다한거
str(gaman_data_food %>% filter(str_extract(gaman_data_food$소재지도로명주소,"매산")=="매산"))
ggplot(total_g, aes(reorder(구분,여객_강차인원), 여객_강차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("전체 강차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(big3_g, aes(reorder(구분,여객_승차인원), 여객_승차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("주요 3역 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(big3_s, aes(reorder(구분,여객_승차인원), 여객_승차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("주요 3역 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(total_g, aes(reorder(구분,여객_강차인원), 여객_강차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("강차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("전체 강차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(big3_g, aes(reorder(구분,여객_강차인원), 여객_강차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("강차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("주요 3지역 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(big3_s, aes(reorder(구분,여객_승차인원), 여객_승차인원, fill=구분  %>% fct_rev())) +geom_col() +
xlab("승차역") + ylab("인원") + scale_fill_discrete(name='역') +ggtitle("주요 3지역 승차인원")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv")
View(toji)
names(toji) <- as.character(unlist(toji[1,]))
View(toji)
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv", header=TRUE)
View(toji)
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv", header=FASLE)
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv", header=FALSE)
View(toji)
names(toji) <- as.character(unlist(toji[1,]))
View(toji)
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv")
names(toji) <- as.character(unlist(toji[1,]))
toji <- toji[2:61,]
View(toji)
toji %>% arrange(desc(주차장))
str(toji)
size_my_data_frame = dim(toji);
size_my_data_frame = dim(toji);
size_my_data_frame
toji[,i] <- imsi;
for(i in 3:size_my_data_frame[2]){
imsi = as.numeric(toji[,i]);
imsi[is.na(imsi)] <- 0     #해당 열에서 NA 값이 있을 경우 0으로 변환
toji[,i] <- imsi;
}
str(toji)
toji %>% arrange(desc(주차장))
toji$주차장[1]
toji[i,"주차장/대지"]=toji$주차장[i]/toji$대지[i]
View(toji)
toji$주차장[1]/toji$주차장[1]
toji$주차장[1]
toji$주차장[1]/toji$대지[1]
for(i in 1:60){
toji[i,"주차장/대지"]=toji$주차장[i]/toji$대지[i]
}
View(toji)
for(i in 1:60){
ifelse(toji[i,"체육용지"]>0,1,0)
}
View(toji)
ifelse(toji[i,"체육용지"]>0,toji[i,"체육용지"]<-1,0)
toji[1,"체육용지"]
toji[1,"체육용지"]>0
View(toji)
ifelse(toji[1,"체육용지"]>0,toji[1,"체육용지"]<-1,0)
View(toji)
ifelse(toji[i,"체육용지"]>0,toji[i,"체육용지"]<-1,toji[i,"체육용지"]<-0)
View(toji)
for(i in 1:60){
ifelse(toji[i,"체육용지"]>0,toji[i,"체육용지"]<-1,toji[i,"체육용지"]<-0)
}
toji
ifelse(toji[i,"체육용지"]>0,toji[i,"체육용지"]==1,toji[i,"체육용지"]==0)
for(i in 1:60){
ifelse(toji[i,"체육용지"]>0,toji[i,"체육용지"]==1,toji[i,"체육용지"]==0)
}
View(toji)
toji %>% select(대지,주차장,체육용지,주차장/대지) %>% arrange(desc(주차장/대지))
toji %>% select(행정구역(구동)별(2),대지,주차장,체육용지,주차장/대지) %>% arrange(desc(주차장/대지))
str(toji)
toji %>% select(toji$`행정구역(구동)별(2)`,대지,주차장,체육용지,주차장/대지) %>% arrange(desc(주차장/대지))
toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,주차장/대지) %>% arrange(desc(주차장/대지))
View(toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,주차장/대지) %>% arrange(desc(주차장/대지)))
toji
View(toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>% arrange(desc(주차장/대지)))
toji_ i <- toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>%filter(str_extract(`행정구역(구동)별(2)`,"인계동")=="인계동")
toji_i <- toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>%filter(str_extract(`행정구역(구동)별(2)`,"인계동")=="인계동")
toji_i <- toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>%filter(str_extract(`행정구역(구동)별(2)`,"인계동")=="인계동")
toji_y <- toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>%filter(str_extract(`행정구역(구동)별(2)`,"영통동")=="영통동")
toji_m <- toji %>% select(`행정구역(구동)별(2)`,대지,주차장,체육용지,`주차장/대지`) %>%filter(str_extract(`행정구역(구동)별(2)`,"매탄동")=="매탄동")
toji_3 <- rbind(toji_y,toji_m,toji_i)
toji_3
coolnames(toji_3[,1]) <- "행정구역"
colnames(toji_3[,1]) <- "행정구역"
colnames(toji_3[1]) <- "행정구역"
toji_3
colnames(toji_3[1]) <- "행정구역"
toji_3
colnames(toji_3)[1] <- "행정구역"
toji_3
ggplot(toji_3, aes(reorder(행정구역,주차장/대지), 주차장/대지, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동이름") + ylab("비율") + scale_fill_discrete(name='동') +ggtitle("주요 3지역 주차장/대지비율")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(toji_3, aes(reorder(행정구역,주차장), 주차장, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동이름") + ylab("주차장크기") + scale_fill_discrete(name='동') +ggtitle("주요 3지역 주차장크기")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(toji_3, aes(reorder(행정구역,체육용지), 체육용지, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동이름") + ylab("체육용지유무") + scale_fill_discrete(name='동') +ggtitle("주요 3지역 체육용지 유무")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
ggplot(toji_3, aes(reorder(행정구역,대지), 대지, fill=행정구역  %>% fct_rev())) +geom_col() +
xlab("동이름") + ylab("대지면적") + scale_fill_discrete(name='동') +ggtitle("주요 3지역 대지면적")+theme(plot.title = element_text(face = "bold", size = 30, color = "darkblue"))
### 토지 지목별 현황
toji <- read.csv("data/토지지목별현황_20210527235436.csv")
